#!/usr/bin/env bash

cat <<EOF >mise.toml
[env]
FOO={value="bar", tools=true}
EOF
assert_contains "mise hook-env -s bash" "export FOO=bar"

cat <<EOF >mise.toml
[env]
WHICH={value="{{ exec(command='which which') }}", tools=true}
EOF
assert_contains "mise hook-env -s bash" "export WHICH=$(which which)"

cat <<EOF >mise.toml
[tools]
tiny = "latest"

[env]
TINY_V = { value = "{{ tools.tiny.version }}", tools = true }
TINY_P = { value = "{{ tools.tiny.path }}", tools = true }
EOF
mise install tiny
TINY_VERSION=$(mise latest tiny)
TINY_PATH=$(mise where tiny)
assert_contains "mise hook-env -s bash" "export TINY_V=$TINY_VERSION"
assert_contains "mise hook-env -s bash" "export TINY_P=$TINY_PATH"
