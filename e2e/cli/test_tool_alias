#!/usr/bin/env bash

# Test 1: tool_alias works as replacement for alias
cat >mise.toml <<'EOF'
[tool_alias.tiny.versions]
lts = "1.0.0"
EOF

mise i tiny@lts
assert_contains "mise ls tiny" "1.0.0"

# Test 2: Deprecated [alias] still works but shows warning
cat >mise.toml <<'EOF'
[alias.tiny.versions]
old = "1.1.0"
EOF

mise i tiny@old
output=$(mise ls tiny 2>&1)
# Should have installed 1.1.0
assert_contains "echo '$output'" "1.1.0"

# Test 3: Both alias and tool_alias can coexist, tool_alias takes precedence
cat >mise.toml <<'EOF'
[alias.tiny.versions]
both = "1.0.0"

[tool_alias.tiny.versions]
both = "1.1.0"
EOF

mise i tiny@both
# tool_alias should take precedence - should install 1.1.0
assert_contains "mise ls tiny" "1.1.0"
