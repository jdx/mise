#!/usr/bin/env bash

# ensures depends_post on multiple tasks works.
cat <<EOF >mise.toml
[tasks.one]
run = "echo one"
depends_post=[
    'two',
    'three'
]

[tasks.two]
run = "echo two"

[tasks.three]
run = "echo three"
EOF

assert "mise task deps" "one
 two
 └── one
 three
 └── one"
assert "mise run one"

# TODO: this does not work with how mise is designed currently. Tasks can only ever be run once per run session. This will require hefty refactoring if it is ever supported
# uses depends and depends_post on the same task
#cat <<EOF >mise.toml
#tasks."util:donothing" = ""
#[tasks.hi]
#depends = "util:donothing"
#run = "echo hi"
#depends_post = "util:donothing"
#EOF
#assert "mise run hi"
