#!/usr/bin/env bash
#MISE description="Fetch GPG keys for signing or verification"
# shellcheck disable=SC2129
set -euxo pipefail

# Fetch all Node.js release keys from the official nodejs/release-keys repository
# This includes all current and legacy release maintainer keys
rm -rf src/assets/gpg
mkdir -p src/assets/gpg

# Download each key file from nodejs/release-keys repository
NODE_KEYS_URL="https://raw.githubusercontent.com/nodejs/release-keys/main/keys"
for fingerprint in $(curl -fsSL "https://raw.githubusercontent.com/nodejs/release-keys/main/keys.list"); do
	curl -fLSs "${NODE_KEYS_URL}/${fingerprint}.asc" >>"src/assets/gpg/node.asc"
done
curl -fLSs "https://swift.org/keys/automatic-signing-key-4.asc" >>src/assets/gpg/swift.asc
curl -fLSs "https://swift.org/keys/release-key-swift-5.x.asc" >>src/assets/gpg/swift.asc
curl -fLSs "https://swift.org/keys/release-key-swift-6.x.asc" >>src/assets/gpg/swift.asc
